[gd_scene load_steps=19 format=2]

[ext_resource path="res://our_environment.tres" type="Environment" id=1]
[ext_resource path="res://Logic/Player.tscn" type="PackedScene" id=2]
[ext_resource path="res://Assets/Sprites/Textures/GrassMatMaker_albedo.png" type="Texture" id=3]
[ext_resource path="res://UI/UI.tscn" type="PackedScene" id=4]
[ext_resource path="res://Objects/Actors/Wagon.tscn" type="PackedScene" id=5]
[ext_resource path="res://Prototyping/TestLevel.gd" type="Script" id=6]
[ext_resource path="res://Objects/Environment/Tree.tscn" type="PackedScene" id=7]
[ext_resource path="res://Objects/Items/Log.tscn" type="PackedScene" id=8]
[ext_resource path="res://Objects/Items/Plant.tscn" type="PackedScene" id=9]
[ext_resource path="res://Assets/Sprites/Textures/GrassMatMaker_normal.png" type="Texture" id=10]
[ext_resource path="res://Assets/Sprites/map_path_mask.png" type="Texture" id=11]
[ext_resource path="res://Assets/Sprites/Textures/DirtMatMaker_albedo.png" type="Texture" id=12]
[ext_resource path="res://Assets/Sprites/Textures/DirtMatMaker_normal.png" type="Texture" id=13]

[sub_resource type="QuadMesh" id=7]

[sub_resource type="Shader" id=5]
code = "// NOTE: Shader automatically converted from Godot Engine 3.4.3.stable's SpatialMaterial.

shader_type spatial;
render_mode blend_mix,depth_draw_opaque,cull_back,diffuse_burley,specular_schlick_ggx;
uniform vec4 albedo : hint_color;
uniform sampler2D grass_texture_albedo : hint_albedo;
uniform sampler2D grass_texture_normal : hint_normal;
uniform sampler2D dirt_texture_albedo : hint_albedo;
uniform sampler2D dirt_texture_normal : hint_normal;
uniform sampler2D ground_mask;
uniform float specular;
uniform float metallic;
uniform float roughness : hint_range(0,1);
uniform float point_size : hint_range(0,128);

uniform float normal_scale : hint_range(-16,16);
uniform vec3 uv1_scale;
uniform vec3 uv1_offset;

uniform vec2 tex_scale;


void vertex() {
	UV=UV*uv1_scale.xy+uv1_offset.xy;
}




void fragment() {
	float mix_factor = smoothstep(0.0, 0.2, texture(ground_mask, UV).r);
	vec4 albedo_tex = mix(texture(grass_texture_albedo, UV*tex_scale), texture(dirt_texture_albedo, UV*tex_scale), mix_factor);
	vec4 normal_tex = mix(texture(grass_texture_normal, UV*tex_scale), texture(dirt_texture_normal, UV*tex_scale), mix_factor);
	ALBEDO = albedo_tex.rgb;
	METALLIC = metallic;
	ROUGHNESS = roughness;
	SPECULAR = specular;
	NORMALMAP = normal_tex.rgb;
	NORMALMAP_DEPTH = normal_scale;
	
	
}
"

[sub_resource type="ShaderMaterial" id=6]
shader = SubResource( 5 )
shader_param/albedo = Color( 1, 1, 1, 1 )
shader_param/specular = 0.5
shader_param/metallic = 0.0
shader_param/roughness = 1.0
shader_param/point_size = 1.0
shader_param/normal_scale = 1.0
shader_param/uv1_scale = Vector3( 1, 1, 1 )
shader_param/uv1_offset = Vector3( 0, 0, 0 )
shader_param/tex_scale = Vector2( 20, 20 )
shader_param/grass_texture_albedo = ExtResource( 3 )
shader_param/grass_texture_normal = ExtResource( 10 )
shader_param/dirt_texture_albedo = ExtResource( 12 )
shader_param/dirt_texture_normal = ExtResource( 13 )
shader_param/ground_mask = ExtResource( 11 )

[sub_resource type="ConcavePolygonShape" id=8]
data = PoolVector3Array( -0.5, -0.5, 0, -0.5, 0.5, 0, 0.5, 0.5, 0, -0.5, -0.5, 0, 0.5, 0.5, 0, 0.5, -0.5, 0 )

[sub_resource type="Curve3D" id=4]
_data = {
"points": PoolVector3Array( 0, 0, 0, 0, 0, 0, -7.53585, 1.06517, -3.76069, 1.78619, 0, 2.29096, -1.78619, 0, -2.29096, -9.06186, 1.00287, -9.90132, -2.6972, -0.445211, 2.15198, 2.6972, 0.445211, -2.15198, -7.02015, 1.09894, -17.0121, -2.06055, 1.90735e-06, 1.93527, 2.06055, -1.90735e-06, -1.93527, 4.80515, 0.725859, -15.2288, 0.492035, 0, 1.1666, -0.492035, 0, -1.1666, 1.65433, 2.38222, -20.2928, 0, 0, 0, 0, 0, 0, 1.29037, 3.81355, -24.054, 0, 0, 0, 0, 0, 0, 0.992816, 4.09518, -26.89, 0, 0, 0, 0, 0, 0, 1.96179, 4.14593, -29.8325, 0, 0, 0, 0, 0, 0, 4.33171, 4.0675, -30.8305, 0, 0, 0, 0, 0, 0, 8.9595, 3.71685, -29.7185, 0, 0, 0, 0, 0, 0, 14.2197, 3.20011, -26.623, 0, 0, 0, 0, 0, 0, 16.4472, 2.94174, -24.6993, 0, 0, 0, 0, 0, 0, 18.9771, 2.60954, -21.9139, 0, 0, 0, 0, 0, 0, 21.8923, 2.14817, -17.4862, 0, 0, 0, 0, 0, 0, 23.5531, 1.70524, -12.1729, 0, 0, 0, 0, 0, 0, 23.549, 1.43303, -7.95022, 0, 0, 0, 0, 0, 0, 22.8816, 1.20695, -3.82301, 0, 0, 0, 0, 0, 0, 20.2232, 0.985489, 2.09224, 0, 0, 0, 0, 0, 0, 13.9172, 0.953194, 8.48284, 0, 0, 0, 0, 0, 0, 10.6138, 1.00856, 10.7102, 0, 0, 0, 0, 0, 0, 7.17936, 0.718634, 9.67446, 0, 0, 0, 0, 0, 0, 6.09038, 1.45881, 5.15722, 0, 0, 0, 0, 0, 0, 9.90159, 2.79861, 1.18161, 0, 0, 0, 0, 0, 0, 15.1185, 4.51318, -3.65929, 0, 0, 0, 0, 0, 0, 14.8721, 5.93731, -11.0074, 0, 0, 0, 0, 0, 0, 9.68263, 6.67749, -18.5038, 0, 0, 0, 0, 0, 0, 6.26819, 6.81803, -21.6921, 0, 0, 0, 0, 0, 0, -0.0704797, 6.79929, -26.203, 0, 0, 0, 0, 0, 0, -2.49943, 6.66759, -27.3048, 0, 0, 0, 0, 0, 0, -4.56341, 6.55569, -28.2411, 0, 0, 0, 0, 0, 0, -7.60705, 6.13407, -28.33, 0, 0, 0, 0, 0, 0, -10.4747, 5.44075, -26.9232, 0, 0, 0, 0, 0, 0, -13.4168, 4.50382, -24.3443, 0, 0, 0, 0, 0, 0, -16.293, 3.02348, -18.9818, 0, 0, 0, 0, 0, 0, -17.6554, 2.41447, -16.906, 0, 0, 0, 0, 0, 0, -18.8866, 1.35575, -12.4708, 0, 0, 0, 0, 0, 0, -18.1171, 0.36261, -6.91222, 0, 0, 0, 0, 0, 0, -9.05941, 0.109638, 0.942023, 0, 0, 0, 0, 0, 0, 2.45682, 0.100267, 9.35623, 0, 0, 0, 0, 0, 0, 8.28303, 0.250177, 12.8346, 0, 0, 0, 0, 0, 0, 12.0783, 0.746746, 13.0922, 0, 0, 0, 0, 0, 0, 15.3962, 1.72115, 10.5977, 0, 0, 0, 0, 0, 0, 18.6972, 2.80799, 7.52484, 0, 0, 0, 0, 0, 0, 20.5102, 3.53879, 5.16317, 0, 0, 0, 0, 0, 0, 22.7079, 4.77553, 0.534062, 0, 0, 0, 0, 0, 0, 23.6492, 5.80615, -3.97017, 0, 0, 0, 0, 0, 0, 24.2091, 6.83677, -8.75155, 0, 0, 0, 0, 0, 0, 21.9816, 7.38018, -13.1055, 0, 0, 0, 0, 0, 0, 19.2307, 7.81117, -17.2738, 0, 0, 0, 0, 0, 0, 0.401967, 7.40829, -28.9255, 0, 0, 0, 0, 0, 0, -0.816908, 7.16469, -28.5848, 0, 0, 0, 0, 0, 0, -1.84135, 6.9492, -28.2443, 0, 0, 0, 0, 0, 0, -3.05232, 6.28398, -25.7754, 0, 0, 0, 0, 0, 0, -2.73913, 6.28398, -24.6598 ),
"tilts": PoolRealArray( 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0 )
}

[node name="TestLevel" type="Spatial"]
script = ExtResource( 6 )

[node name="Ground" type="MeshInstance" parent="."]
transform = Transform( 157.029, 0.0211611, 1.76715e-10, 0, -6.86395e-06, 30, 0.0211611, -157.029, -1.31134e-06, 0, 0, 7.37393 )
mesh = SubResource( 7 )
material/0 = SubResource( 6 )

[node name="StaticBody" type="StaticBody" parent="Ground"]

[node name="CollisionShape" type="CollisionShape" parent="Ground/StaticBody"]
shape = SubResource( 8 )

[node name="WorldEnvironment" type="WorldEnvironment" parent="."]
environment = ExtResource( 1 )

[node name="DirectionalLight" type="DirectionalLight" parent="."]
transform = Transform( -0.866046, -0.209412, 0.453994, 0.00646802, 0.903285, 0.428992, -0.499922, 0.374464, -0.780932, 0, 6.51142, 2.99369 )
light_color = Color( 0.490196, 0.666667, 1, 1 )
light_energy = 0.105
shadow_enabled = true
shadow_color = Color( 0.34902, 0.34902, 0.34902, 1 )

[node name="Player" parent="." instance=ExtResource( 2 )]
transform = Transform( 1, 0, 0, 0, 1, 0, 0, 0, 1, -12.4105, 0.353998, -0.788541 )

[node name="RemoteTransform" type="RemoteTransform" parent="Player"]
transform = Transform( 1, 0, 0, 0, 0.707107, -0.707107, 0, 0.707107, 0.707107, 0, 1.10269, 0 )
remote_path = NodePath("../../Pivot")
update_rotation = false
update_scale = false

[node name="Pivot" type="Spatial" parent="."]
transform = Transform( 1, 0, 0, 0, 0.5, 0.866026, 0, -0.866026, 0.5, -12.4105, 1.45669, -0.788541 )

[node name="Camera" type="Camera" parent="Pivot"]
transform = Transform( 1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 7 )
current = true

[node name="UI" parent="." instance=ExtResource( 4 )]

[node name="Wagon" parent="." instance=ExtResource( 5 )]
transform = Transform( 1, 0, 0, 0, 1, 0, 0, 0, 1, 0, -0.00918525, 0 )
wagon_path = NodePath("../WagonPath")

[node name="WagonPath" type="Path" parent="."]
transform = Transform( 0.999999, 0, 0, 0, 1, 0, 0, 0, 0.999999, 0, 0, 0 )
curve = SubResource( 4 )

[node name="Tween" type="Tween" parent="."]

[node name="Tree2" parent="." instance=ExtResource( 7 )]
transform = Transform( 1, 0, 0, 0, 1, 0, 0, 0, 1, -2.68382, 0.0540286, -24.5684 )

[node name="Tree" parent="." instance=ExtResource( 7 )]
transform = Transform( 1, 0, 0, 0, 1, 0, 0, 0, 1, -3.74471, 0.0540291, -12.6243 )

[node name="Log" parent="." instance=ExtResource( 8 )]
transform = Transform( 1, 0, 0, 0, 1, 0, 0, 0, 1, 0.913687, 0.0977135, -13.0104 )

[node name="Log2" parent="." instance=ExtResource( 8 )]
transform = Transform( 1, 0, 0, 0, 1, 0, 0, 0, 1, -1.02963, 0.0977135, -12.6322 )

[node name="Log3" parent="." instance=ExtResource( 8 )]
transform = Transform( 1, 0, 0, 0, 1, 0, 0, 0, 1, 6.82041, 0.0977136, -11.9905 )

[node name="Log4" parent="." instance=ExtResource( 8 )]
transform = Transform( 1, 0, 0, 0, 1, 0, 0, 0, 1, 1.9676, 0.0977132, -19.0448 )

[node name="Log5" parent="." instance=ExtResource( 8 )]
transform = Transform( 1, 0, 0, 0, 1, 0, 0, 0, 1, -0.37874, 0.0977135, -13.9333 )

[node name="Log6" parent="." instance=ExtResource( 8 )]
transform = Transform( 1, 0, 0, 0, 1, 0, 0, 0, 1, 0.218701, 0.0977136, -11.806 )

[node name="Plant" parent="." instance=ExtResource( 9 )]
transform = Transform( 1, 0, 0, 0, 1, 0, 0, 0, 1, 3.83848, -0.29398, -8.22569 )
